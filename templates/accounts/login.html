{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Login - Milk Billing System</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" />
  <style>
    :root{
      --bg-start: #667eea;
      --bg-end: #764ba2;
      --card-bg: #ffffff;
      --muted: #6b7280;
      --accent-1: #1e3c72;
      --accent-2: #2a5298;
      --success: #2ecc71;
      --danger: #e63946;
      --radius: 12px;
      --shadow-lg: 0 18px 50px rgba(16,24,40,0.18);
    }

    html,body{height:100%}
    body{
      margin:0;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, var(--bg-start) 0%, var(--bg-end) 100%);
      display:flex;
      align-items:center;
      justify-content:center;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      padding:24px;
    }

    .login-container{
      width:100%;
      max-width:520px;
      background: linear-gradient(180deg, rgba(255,255,255,0.98), var(--card-bg));
      border-radius: var(--radius);
      box-shadow: var(--shadow-lg);
      padding:34px;
      position:relative;
      overflow:hidden;
      border: 1px solid rgba(255,255,255,0.06);
      animation: popIn 520ms cubic-bezier(.2,.9,.2,1);
    }

    .login-header{
      text-align:center;
      margin-bottom:22px;
    }
    .logo-icon{
      font-size:48px;
      display:inline-block;
      width:72px;
      height:72px;
      line-height:72px;
      border-radius:18px;
      background: linear-gradient(90deg,var(--bg-start),var(--bg-end));
      color:#fff;
      box-shadow: 0 8px 30px rgba(16,24,40,0.12);
      margin-bottom:12px;
    }
    .login-header h1{
      margin:0;
      font-size:26px;
      color:var(--accent-1);
      font-weight:800;
      letter-spacing:0.2px;
    }
    .login-header p{
      margin:6px 0 0;
      color:var(--muted);
      font-size:14px;
    }

    .error-messages{
      background: #fff5f6;
      border: 1px solid rgba(230,57,70,0.08);
      color: var(--danger);
      padding:12px 14px;
      border-radius:10px;
      margin-bottom:16px;
      font-size:14px;
    }
    .error-messages ul{ margin:0; padding-left:18px; }
    .error-messages li{ margin-bottom:6px; }

    form .form-group{
      margin-bottom:14px;
    }
    label.form-label{
      display:block;
      margin-bottom:8px;
      font-weight:700;
      color:#24303a;
      font-size:14px;
    }
    input.form-control{
      width:100%;
      padding:12px 14px;
      border-radius:10px;
      border:1px solid #e6e9ee;
      font-size:15px;
      color:#24303a;
      transition: box-shadow .18s ease, border-color .18s ease, transform .18s ease;
      outline:none;
      background:transparent;
    }
    input.form-control:focus{
      border-color: var(--bg-start);
      box-shadow: 0 10px 30px rgba(102,126,234,0.08);
      transform: translateY(-2px);
    }

    .remember-me{
      display:flex;
      align-items:center;
      gap:10px;
      margin:12px 0 6px;
      color:var(--muted);
      font-weight:600;
      font-size:14px;
    }
    .remember-me input{ width:18px; height:18px; cursor:pointer; }

    .login-btn{
      width:100%;
      padding:12px;
      border-radius:10px;
      border:none;
      color:#fff;
      font-weight:800;
      font-size:16px;
      background: linear-gradient(135deg, var(--bg-start) 0%, var(--bg-end) 100%);
      cursor:pointer;
      transition: transform .18s ease, box-shadow .18s ease;
      box-shadow: 0 12px 36px rgba(102,126,234,0.14);
    }
    .login-btn:hover{ transform: translateY(-4px); box-shadow: 0 22px 48px rgba(102,126,234,0.18); }

    .signup-link{
      text-align:center;
      margin-top:18px;
      padding-top:16px;
      border-top:1px solid rgba(16,24,40,0.04);
      color:var(--muted);
      font-size:14px;
    }
    .signup-link a{ color:var(--bg-start); font-weight:700; text-decoration:none; }
    .signup-link a:hover{ text-decoration:underline; }

    .admin-link{ margin-top:10px; text-align:center; font-size:13px; color:var(--muted); }

    /* small helpers */
    .sr-only { position:absolute; left:-10000px; top:auto; width:1px; height:1px; overflow:hidden; }

    @keyframes popIn {
      0% { opacity:0; transform: translateY(10px) scale(.995); }
      60% { opacity:1; transform: translateY(-6px) scale(1.01); }
      100% { transform: translateY(0) scale(1); }
    }

    @media (max-width:520px){
      .login-container{ padding:20px; border-radius:10px; }
      .logo-icon{ width:64px; height:64px; line-height:64px; font-size:40px; }
    }
  </style>
</head>
<body>
  <main class="login-container" role="main" aria-labelledby="loginTitle">
    <header class="login-header" aria-hidden="false">
      <div class="logo-icon" aria-hidden="true">ðŸ¥›</div>
      <h1 id="loginTitle">Milk Billing</h1>
      <p>Sign in to your account</p>
    </header>

    <!-- Non-field errors -->
    {% if form.non_field_errors %}
      <div class="error-messages" role="alert" aria-live="polite">
        {% for err in form.non_field_errors %}
          <div>{{ err }}</div>
        {% endfor %}
      </div>
    {% endif %}

    <!-- Field-specific errors summary -->
    {% if form.errors %}
      <div class="error-messages" role="alert" aria-live="polite">
        <ul>
          {% for field, errors in form.errors.items %}
            {% for error in errors %}
              <li><strong>{{ field|capfirst }}:</strong> {{ error }}</li>
            {% endfor %}
          {% endfor %}
        </ul>
      </div>
    {% endif %}

    <form method="post" novalidate autocomplete="on" aria-describedby="loginHelp">
      {% csrf_token %}

      <!-- Username -->
      <div class="form-group">
        <label for="id_username" class="form-label">ðŸ‘¤ Username</label>
        <input
          type="text"
          name="username"
          id="id_username"
          class="form-control"
          placeholder="Enter your username"
          value="{{ request.POST.username|default:'' }}"
          required
          autofocus
          aria-required="true"
          aria-label="Username"
        >
      </div>

      <!-- Password -->
      <div class="form-group">
        <label for="id_password" class="form-label">ðŸ”’ Password</label>
        <input
          type="password"
          name="password"
          id="id_password"
          class="form-control"
          placeholder="Enter your password"
          required
          aria-required="true"
          aria-label="Password"
        >
      </div>

      <!-- Remember me -->
      <div class="remember-me">
        <input type="checkbox" name="remember_me" id="remember_me" {% if request.POST.remember_me %}checked{% endif %}>
        <label for="remember_me">Remember me</label>
      </div>

      <button type="submit" class="login-btn" aria-label="Login">ðŸ”“ Login</button>

      <div id="loginHelp" class="sr-only">Use your username and password to sign in. Press Enter to submit.</div>
    </form>

    <div class="admin-link">
      <p>Admin? <a href="{% url 'admin:index' %}">Go to Admin Panel</a></p>
    </div>
  </main>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    // Focus first visible input on load
    (function(){
      const u = document.getElementById('id_username');
      if (u) u.focus();
    })();

    // Keyboard shortcuts (non-invasive)
    document.addEventListener('keydown', function(e) {
      if (e.ctrlKey && !e.shiftKey && !e.altKey) {
        const k = e.key.toLowerCase();
        if (k === 'h') { // Ctrl+H â†’ Home/dashboard
          e.preventDefault();
          window.location.href = "{% url 'accounts:home' %}";
        } else if (k === 'e') { // Ctrl+E â†’ Add entry
          e.preventDefault();
          window.location.href = "{% url 'accounts:add_entry' %}";
        }
      }
      // Enter submits the form naturally; Escape clears password field
      if (e.key === 'Escape') {
        const pwd = document.getElementById('id_password');
        if (pwd) pwd.value = '';
      }
    });
  </script>
</body>
</html>
